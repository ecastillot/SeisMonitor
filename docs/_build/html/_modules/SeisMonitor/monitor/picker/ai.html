

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SeisMonitor.monitor.picker.ai &mdash; SeisMonitor 0.0.57 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../_static/documentation_options.js?v=2bfb35b6"></script>
      <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            SeisMonitor
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../SeisMonitor.core.html">Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../SeisMonitor.monitor.html">Monitor</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">SeisMonitor</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">SeisMonitor.monitor.picker.ai</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for SeisMonitor.monitor.picker.ai</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">genericpath</span><span class="w"> </span><span class="kn">import</span> <span class="n">isdir</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">utils</span> <span class="k">as</span> <span class="n">ut</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">dt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tf</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">git</span><span class="w"> </span><span class="kn">import</span> <span class="n">Repo</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">SeisMonitor.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">printlog</span><span class="p">,</span> <span class="n">isfile</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">EQTransformer.core.mseed_predictor</span><span class="w"> </span><span class="kn">import</span> <span class="n">mseed_predictor</span>

<span class="c1"># Suppress warnings and TensorFlow logging</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>
<span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">logging</span><span class="o">.</span><span class="n">set_verbosity</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>


<div class="viewcode-block" id="EQTransformerObj">
<a class="viewcode-back" href="../../../../SeisMonitor.monitor.picker.html#SeisMonitor.monitor.picker.ai.EQTransformerObj">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">EQTransformerObj</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration object for EQTransformer parameters.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model_path</span><span class="p">,</span>
        <span class="n">n_processor</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">overlap</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
        <span class="n">detection_threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
        <span class="n">P_threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
        <span class="n">S_threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
        <span class="n">number_of_plots</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">plot_mode</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">rm_downloads</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize EQTransformerObj with prediction parameters.</span>

<span class="sd">        Args:</span>
<span class="sd">            model_path (str): Path to the trained EQTransformer model</span>
<span class="sd">            n_processor (int): Number of processors to use</span>
<span class="sd">            overlap (float): Overlap between prediction windows (0-1)</span>
<span class="sd">            detection_threshold (float): Minimum detection probability</span>
<span class="sd">            P_threshold (float): Minimum P-phase probability</span>
<span class="sd">            S_threshold (float): Minimum S-phase probability</span>
<span class="sd">            number_of_plots (int): Number of plots to generate</span>
<span class="sd">            batch_size (int): Number of waveforms per batch</span>
<span class="sd">            plot_mode (int): Plotting mode for visualization</span>
<span class="sd">            overwrite (bool): Whether to overwrite existing outputs</span>
<span class="sd">            rm_downloads (bool): Whether to remove input MSEED files after processing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_path</span> <span class="o">=</span> <span class="n">model_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_processor</span> <span class="o">=</span> <span class="n">n_processor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overlap</span> <span class="o">=</span> <span class="n">overlap</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detection_threshold</span> <span class="o">=</span> <span class="n">detection_threshold</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P_threshold</span> <span class="o">=</span> <span class="n">P_threshold</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">S_threshold</span> <span class="o">=</span> <span class="n">S_threshold</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_plots</span> <span class="o">=</span> <span class="n">number_of_plots</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="n">batch_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_mode</span> <span class="o">=</span> <span class="n">plot_mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overwrite</span> <span class="o">=</span> <span class="n">overwrite</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rm_downloads</span> <span class="o">=</span> <span class="n">rm_downloads</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;EQTransformer&quot;</span></div>



<div class="viewcode-block" id="PhaseNetObj">
<a class="viewcode-back" href="../../../../SeisMonitor.monitor.picker.html#SeisMonitor.monitor.picker.ai.PhaseNetObj">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">PhaseNetObj</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration object for PhaseNet parameters.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">pnet_path</span><span class="p">,</span>
        <span class="n">model_path</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;pred&#39;</span><span class="p">,</span>
        <span class="n">P_threshold</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
        <span class="n">S_threshold</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">save_result</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
        <span class="n">decay_step</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">decay_rate</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
        <span class="n">momentum</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
        <span class="n">filters_root</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
        <span class="n">depth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">kernel_size</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="n">pool_size</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="n">drop_rate</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">dilation_rate</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="n">loss_type</span><span class="o">=</span><span class="s2">&quot;cross_entropy&quot;</span><span class="p">,</span>
        <span class="n">weight_decay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">optimizer</span><span class="o">=</span><span class="s2">&quot;adam&quot;</span><span class="p">,</span>
        <span class="n">summary</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">class_weights</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="n">log_dir</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span>
        <span class="n">num_plots</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">input_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">input_mseed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">filename_picks</span><span class="o">=</span><span class="s2">&quot;picks&quot;</span><span class="p">,</span>
        <span class="n">one_single_sampling_rate</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">data_dir</span><span class="o">=</span><span class="s2">&quot;./dataset/waveform_pred/&quot;</span><span class="p">,</span>
        <span class="n">data_list</span><span class="o">=</span><span class="s2">&quot;./dataset/waveform.csv&quot;</span><span class="p">,</span>
        <span class="n">train_dir</span><span class="o">=</span><span class="s2">&quot;./dataset/waveform_train/&quot;</span><span class="p">,</span>
        <span class="n">train_list</span><span class="o">=</span><span class="s2">&quot;./dataset/waveform.csv&quot;</span><span class="p">,</span>
        <span class="n">valid_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">valid_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">output_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">rm_downloads</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize PhaseNetObj with prediction parameters.</span>

<span class="sd">        Args:</span>
<span class="sd">            pnet_path (str): Path to PhaseNet repository</span>
<span class="sd">            model_path (str): Path to trained PhaseNet model</span>
<span class="sd">            mode (str): Operation mode (&#39;pred&#39; for prediction)</span>
<span class="sd">            P_threshold (float): Minimum P-phase probability</span>
<span class="sd">            S_threshold (float): Minimum S-phase probability</span>
<span class="sd">            batch_size (int): Number of waveforms per batch</span>
<span class="sd">            plot (bool): Whether to generate plots</span>
<span class="sd">            save_result (bool): Whether to save prediction results</span>
<span class="sd">            epochs (int): Number of training epochs</span>
<span class="sd">            learning_rate (float): Initial learning rate</span>
<span class="sd">            decay_step (int): Steps for learning rate decay</span>
<span class="sd">            decay_rate (float): Learning rate decay rate</span>
<span class="sd">            momentum (float): Momentum for optimizer</span>
<span class="sd">            filters_root (int): Base number of filters</span>
<span class="sd">            depth (int): Network depth</span>
<span class="sd">            kernel_size (list): Kernel size for convolution</span>
<span class="sd">            pool_size (list): Pooling size</span>
<span class="sd">            drop_rate (float): Dropout rate</span>
<span class="sd">            dilation_rate (list): Dilation rate for convolution</span>
<span class="sd">            loss_type (str): Loss function type</span>
<span class="sd">            weight_decay (float): Weight decay factor</span>
<span class="sd">            optimizer (str): Optimizer type</span>
<span class="sd">            summary (bool): Whether to show summary</span>
<span class="sd">            class_weights (list): Weights for class balancing</span>
<span class="sd">            log_dir (str): Directory for logs</span>
<span class="sd">            num_plots (int): Number of plots to generate</span>
<span class="sd">            input_length (int, optional): Input length in samples</span>
<span class="sd">            input_mseed (bool): Whether input is MSEED format</span>
<span class="sd">            filename_picks (str): Base name for picks output file</span>
<span class="sd">            one_single_sampling_rate (float): Override sampling rate (-1 for auto)</span>
<span class="sd">            data_dir (str): Directory for prediction data</span>
<span class="sd">            data_list (str): Path to data list CSV</span>
<span class="sd">            train_dir (str): Directory for training data</span>
<span class="sd">            train_list (str): Path to training list CSV</span>
<span class="sd">            valid_dir (str, optional): Directory for validation data</span>
<span class="sd">            valid_list (str, optional): Path to validation list CSV</span>
<span class="sd">            output_dir (str, optional): Directory for output</span>
<span class="sd">            rm_downloads (bool): Whether to remove input MSEED files after processing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phasenet_path</span> <span class="o">=</span> <span class="n">pnet_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_path</span> <span class="o">=</span> <span class="n">model_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span> <span class="o">=</span> <span class="n">model_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tp_prob</span> <span class="o">=</span> <span class="n">P_threshold</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ts_prob</span> <span class="o">=</span> <span class="n">S_threshold</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="n">batch_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_figure</span> <span class="o">=</span> <span class="n">plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_result</span> <span class="o">=</span> <span class="n">save_result</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span> <span class="o">=</span> <span class="n">epochs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="n">learning_rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decay_step</span> <span class="o">=</span> <span class="n">decay_step</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decay_rate</span> <span class="o">=</span> <span class="n">decay_rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">momentum</span> <span class="o">=</span> <span class="n">momentum</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filters_root</span> <span class="o">=</span> <span class="n">filters_root</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">depth</span> <span class="o">=</span> <span class="n">depth</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kernel_size</span> <span class="o">=</span> <span class="n">kernel_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pool_size</span> <span class="o">=</span> <span class="n">pool_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drop_rate</span> <span class="o">=</span> <span class="n">drop_rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dilation_rate</span> <span class="o">=</span> <span class="n">dilation_rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loss_type</span> <span class="o">=</span> <span class="n">loss_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weight_decay</span> <span class="o">=</span> <span class="n">weight_decay</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optimizer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">summary</span> <span class="o">=</span> <span class="n">summary</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">class_weights</span> <span class="o">=</span> <span class="n">class_weights</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span> <span class="o">=</span> <span class="n">log_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_plots</span> <span class="o">=</span> <span class="n">num_plots</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_length</span> <span class="o">=</span> <span class="n">input_length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_mseed</span> <span class="o">=</span> <span class="n">input_mseed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fpred</span> <span class="o">=</span> <span class="n">filename_picks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">data_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_list</span> <span class="o">=</span> <span class="n">data_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_dir</span> <span class="o">=</span> <span class="n">train_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_list</span> <span class="o">=</span> <span class="n">train_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valid_dir</span> <span class="o">=</span> <span class="n">valid_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valid_list</span> <span class="o">=</span> <span class="n">valid_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span> <span class="o">=</span> <span class="n">output_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overlap</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rm_downloads</span> <span class="o">=</span> <span class="n">rm_downloads</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">one_single_sampling_rate</span> <span class="o">=</span> <span class="n">one_single_sampling_rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;PhaseNet&quot;</span></div>



<div class="viewcode-block" id="EQTransformer">
<a class="viewcode-back" href="../../../../SeisMonitor.monitor.picker.html#SeisMonitor.monitor.picker.ai.EQTransformer">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">EQTransformer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class to run EQTransformer predictions.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eqt_obj</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize EQTransformer with configuration object.</span>

<span class="sd">        Args:</span>
<span class="sd">            eqt_obj (EQTransformerObj): Configuration object for EQTransformer</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eqt_obj</span> <span class="o">=</span> <span class="n">eqt_obj</span>

<div class="viewcode-block" id="EQTransformer.pick">
<a class="viewcode-back" href="../../../../SeisMonitor.monitor.picker.html#SeisMonitor.monitor.picker.ai.EQTransformer.pick">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">pick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mseed_storage</span><span class="p">,</span> <span class="n">metadata_dir</span><span class="p">,</span> <span class="n">out_dir</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run EQTransformer picking on MSEED files.</span>

<span class="sd">        Args:</span>
<span class="sd">            mseed_storage (str): Directory containing MSEED files</span>
<span class="sd">            metadata_dir (str): Directory containing station metadata</span>
<span class="sd">            out_dir (str): Output directory for results</span>

<span class="sd">        Returns:</span>
<span class="sd">            pandas.DataFrame: DataFrame of picks in SeisMonitor format</span>

<span class="sd">        Notes:</span>
<span class="sd">            Saves results to {out_dir}/results/seismonitor_picks.csv</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mseed_storage</span> <span class="o">=</span> <span class="n">mseed_storage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">json_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">metadata_dir</span><span class="p">,</span> <span class="s2">&quot;stations.json&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pick_storage</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="s2">&quot;results&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_author</span> <span class="o">=</span> <span class="s2">&quot;Picker: EQTransformer&quot;</span>

        <span class="n">tic</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">printlog</span><span class="p">(</span><span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg_author</span><span class="p">,</span> <span class="s1">&#39;Running EQTransformer&#39;</span><span class="p">)</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">reset_default_graph</span><span class="p">()</span>
            <span class="n">mseed_predictor</span><span class="p">(</span>
                <span class="n">input_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mseed_storage</span><span class="p">,</span>
                <span class="n">input_model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">eqt_obj</span><span class="o">.</span><span class="n">model_path</span><span class="p">,</span>
                <span class="n">stations_json</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">json_path</span><span class="p">,</span>
                <span class="n">output_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pick_storage</span><span class="p">,</span>
                <span class="n">detection_threshold</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">eqt_obj</span><span class="o">.</span><span class="n">detection_threshold</span><span class="p">,</span>
                <span class="n">P_threshold</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">eqt_obj</span><span class="o">.</span><span class="n">P_threshold</span><span class="p">,</span>
                <span class="n">S_threshold</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">eqt_obj</span><span class="o">.</span><span class="n">S_threshold</span><span class="p">,</span>
                <span class="n">number_of_plots</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">eqt_obj</span><span class="o">.</span><span class="n">number_of_plots</span><span class="p">,</span>
                <span class="n">plot_mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">eqt_obj</span><span class="o">.</span><span class="n">plot_mode</span><span class="p">,</span>
                <span class="n">overlap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">eqt_obj</span><span class="o">.</span><span class="n">overlap</span><span class="p">,</span>
                <span class="n">batch_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">eqt_obj</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span>
                <span class="n">overwrite</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">eqt_obj</span><span class="o">.</span><span class="n">overwrite</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;NoneType&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot;length 0&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
                <span class="n">printlog</span><span class="p">(</span>
                    <span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg_author</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s2">&quot;Error in batch_size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">eqt_obj</span><span class="o">.</span><span class="n">batch_size</span><span class="si">}</span><span class="s2"> to the last mseed. &quot;</span>
                    <span class="s2">&quot;Check &#39;to_pick&#39; parameter in DownloadRestrictions&quot;</span>
                <span class="p">)</span>

        <span class="n">output_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pick_storage</span><span class="p">,</span> <span class="s2">&quot;seismonitor_picks.csv&quot;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">eqt_picks_2_seismonitor_fmt</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pick_storage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mseed_storage</span><span class="p">,</span> <span class="n">output_path</span>
        <span class="p">)</span>
        
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">clear_session</span><span class="p">()</span>
        <span class="n">toc</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">exetime</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">toc</span> <span class="o">-</span> <span class="n">tic</span><span class="p">)</span>
        <span class="n">printlog</span><span class="p">(</span>
            <span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg_author</span><span class="p">,</span>
            <span class="sa">f</span><span class="s1">&#39;Total time of execution: </span><span class="si">{</span><span class="n">exetime</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span><span class="si">}</span><span class="s1"> seconds&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eqt_obj</span><span class="o">.</span><span class="n">rm_downloads</span><span class="p">:</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mseed_storage</span><span class="p">,</span> <span class="n">ignore_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">result</span></div>
</div>



<div class="viewcode-block" id="PhaseNet">
<a class="viewcode-back" href="../../../../SeisMonitor.monitor.picker.html#SeisMonitor.monitor.picker.ai.PhaseNet">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">PhaseNet</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class to run PhaseNet predictions.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pnet_obj</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize PhaseNet with configuration object.</span>

<span class="sd">        Args:</span>
<span class="sd">            pnet_obj (PhaseNetObj): Configuration object for PhaseNet</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pnet_obj</span> <span class="o">=</span> <span class="n">pnet_obj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_author</span> <span class="o">=</span> <span class="s2">&quot;Picker: PhaseNet&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__mv_downloads2onefolder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Move MSEED files to a single folder for processing.&quot;&quot;&quot;</span>
        <span class="n">tic</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datadir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datadir</span><span class="p">)</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">mv_mseed2onefolder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mseed_storage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">datadir</span><span class="p">)</span>
        <span class="n">toc</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">exetime</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">toc</span> <span class="o">-</span> <span class="n">tic</span><span class="p">)</span>
        <span class="n">printlog</span><span class="p">(</span>
            <span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg_author</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;Moving mseed2onefolder in </span><span class="si">{</span><span class="n">exetime</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span><span class="si">}</span><span class="s2"> seconds.&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__mv_downloads2stationfolder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Move MSEED files back to station-specific folders.&quot;&quot;&quot;</span>
        <span class="n">tic</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">mv_mseed2stationfolder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datadir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mseed_storage</span><span class="p">)</span>
        <span class="n">toc</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">exetime</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">toc</span> <span class="o">-</span> <span class="n">tic</span><span class="p">)</span>
        <span class="n">printlog</span><span class="p">(</span>
            <span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg_author</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;Moving mseed2stationfolder in </span><span class="si">{</span><span class="n">exetime</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span><span class="si">}</span><span class="s2"> seconds.&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__make_datalist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create datalist for PhaseNet processing.&quot;&quot;&quot;</span>
        <span class="n">tic</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">printlog</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg_author</span><span class="p">,</span> <span class="s2">&quot;Running to create datalist&quot;</span><span class="p">)</span>
        
        <span class="n">ut</span><span class="o">.</span><span class="n">make_phasenet_datalist</span><span class="p">(</span>
            <span class="n">datadir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">datadir</span><span class="p">,</span>
            <span class="n">json_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">json_path</span><span class="p">,</span>
            <span class="n">datalist_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">datalist</span>
        <span class="p">)</span>
        
        <span class="n">toc</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">exetime</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">toc</span> <span class="o">-</span> <span class="n">tic</span><span class="p">)</span>
        <span class="n">printlog</span><span class="p">(</span>
            <span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg_author</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;Datalist created in </span><span class="si">{</span><span class="n">exetime</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span><span class="si">}</span><span class="s2"> seconds.&quot;</span>
        <span class="p">)</span>

<div class="viewcode-block" id="PhaseNet.pick">
<a class="viewcode-back" href="../../../../SeisMonitor.monitor.picker.html#SeisMonitor.monitor.picker.ai.PhaseNet.pick">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">pick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mseed_storage</span><span class="p">,</span> <span class="n">metadata_dir</span><span class="p">,</span> <span class="n">out_dir</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run PhaseNet picking on MSEED files.</span>

<span class="sd">        Args:</span>
<span class="sd">            mseed_storage (str): Directory containing MSEED files</span>
<span class="sd">            metadata_dir (str): Directory containing station metadata</span>
<span class="sd">            out_dir (str): Output directory for results</span>

<span class="sd">        Returns:</span>
<span class="sd">            pandas.DataFrame: DataFrame of picks in SeisMonitor format</span>

<span class="sd">        Notes:</span>
<span class="sd">            Saves results to {out_dir}/results/seismonitor_picks.csv</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mseed_storage</span> <span class="o">=</span> <span class="n">mseed_storage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">json_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">metadata_dir</span><span class="p">,</span> <span class="s2">&quot;stations.json&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pick_storage</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="s2">&quot;results&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">datadir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="s2">&quot;datadir&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">datalist</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="s2">&quot;datalist&quot;</span><span class="p">,</span> <span class="s1">&#39;fname.csv&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__mv_downloads2onefolder</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__make_datalist</span><span class="p">()</span>

        <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">reset_default_graph</span><span class="p">()</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">clear_session</span><span class="p">()</span>

        <span class="n">tic</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">printlog</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg_author</span><span class="p">,</span> <span class="s2">&quot;Running PhaseNet pretrained model.&quot;</span><span class="p">)</span>

        <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pnet_obj</span>
        <span class="n">args</span><span class="o">.</span><span class="n">data_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">datadir</span>
        <span class="n">args</span><span class="o">.</span><span class="n">data_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">datalist</span>
        <span class="n">args</span><span class="o">.</span><span class="n">output_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pick_storage</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">phasenet_from_console</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg_author</span><span class="p">)</span>
        <span class="n">datapicks</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pick_storage</span><span class="p">,</span> <span class="s1">&#39;picks.csv&#39;</span><span class="p">)</span>
        <span class="n">seismonitor_datapicks</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pick_storage</span><span class="p">,</span> <span class="s1">&#39;seismonitor_picks.csv&#39;</span><span class="p">)</span>
        
        <span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_picks</span><span class="p">(</span>
            <span class="n">datapicks</span><span class="o">=</span><span class="n">datapicks</span><span class="p">,</span>
            <span class="n">datalist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">datalist</span><span class="p">,</span>
            <span class="n">min_p_prob</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pnet_obj</span><span class="o">.</span><span class="n">tp_prob</span><span class="p">,</span>
            <span class="n">min_s_prob</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pnet_obj</span><span class="o">.</span><span class="n">ts_prob</span><span class="p">,</span>
            <span class="n">one_single_sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pnet_obj</span><span class="o">.</span><span class="n">one_single_sampling_rate</span><span class="p">,</span>
            <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;df_obj&#39;</span><span class="p">,</span>
            <span class="n">export</span><span class="o">=</span><span class="n">seismonitor_datapicks</span>
        <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">ut</span><span class="o">.</span><span class="n">rm_phasenet_duplicate_picks</span><span class="p">(</span>
                <span class="n">path</span><span class="o">=</span><span class="n">seismonitor_datapicks</span><span class="p">,</span>
                <span class="n">output_path</span><span class="o">=</span><span class="n">seismonitor_datapicks</span>
            <span class="p">)</span>
            <span class="n">printlog</span><span class="p">(</span>
                <span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg_author</span><span class="p">,</span>
                <span class="sa">f</span><span class="s1">&#39;Duplicated picks had been removed. See your results in </span><span class="si">{</span><span class="n">seismonitor_datapicks</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">printlog</span><span class="p">(</span>
                <span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg_author</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;Can&#39;t remove duplicated picks: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="n">toc</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">exetime</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">toc</span> <span class="o">-</span> <span class="n">tic</span><span class="p">)</span>
        <span class="n">printlog</span><span class="p">(</span>
            <span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg_author</span><span class="p">,</span>
            <span class="sa">f</span><span class="s1">&#39;Time of prediction: </span><span class="si">{</span><span class="n">exetime</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span><span class="si">}</span><span class="s1"> seconds&#39;</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__mv_downloads2stationfolder</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pnet_obj</span><span class="o">.</span><span class="n">rm_downloads</span><span class="p">:</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mseed_storage</span><span class="p">,</span> <span class="n">ignore_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Emmanuel Castillo.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>